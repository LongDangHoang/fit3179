<!DOCTYPE html>
<html>

<head>
  <title>FIT3179 - Assignment 2 - Long Dang</title>
  <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>

  <!-- Import pure.css -->
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.3/build/pure-min.css"
    integrity="sha384-cg6SkqEOCV1NbJoCu11+bm0NvBRc8IYLRGXkmNrqUBfTjmMYwNKPWBTIKyw9mHNJ" crossorigin="anonymous">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">

  <!-- CSS file -->
  <link rel="stylesheet" type="text/css" href="css/styles.css" media="all">
</head>

<body>

  <div class="page">
    <!-- Title row -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <div style="text-align: center;">
          <h1>Visualisation of the production of food worldwide</h1>
          <h2>FIT3179 - Assignment 2 - Long Dang</h2>
          <p>
            Of the United Nations' 20 Sustainable Development goals, the second is Zero Hunger.
            Is that a realistic goal? Do we have enough food to feed everyone in the future?
            What is the main food produced in the world? 
            This visualisation aims to provide a brief overview of the current agriculture and foodstuff production globally, with a view to shed light on those questions.
          </p>
        </div>
      </div>
    </div>

    <!-- Header row for section 1 -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <h2>The growth of productivity</h2>
      </div>
    </div>

    <!-- preface row -->
    <div class="pure-g">
      <div class="pure-u-1-3">
        <div class="description description-left">
          <p>
            Over the last 20 years, there has been an increase in agriculture productivity. Yield (defined as tonnes/ha) has increased for many crop types across many countries.
            <br>
            <br>
            Use the slider on the right to see how things have changed. Use mouse to pan and zoom on the graph.
            <br>
            <br>
            For cereal in particular, which includes rice, wheat, and corn, productivity has increased
            in nearly every country, but most noticeably in South America and Central Asia.
            Cereal is the main source of energy we consume as food, and this increase in productivity
            has helped feed the growing population of the world.
          </p>
        </div>
      </div>
      <div class="pure-u-2-3">
        <!-- <div id="vis_map_year"></div> -->
        <div id="vis_map_year_cereals" class="vis_map_year"></div>
        <div id="vis_map_year_fruits_and_nuts" class="vis_map_year"></div>
        <div id="vis_map_year_vegetables" class="vis_map_year"></div>
        <div id="vis_map_year_meat" class="vis_map_year"></div>
        <div id="vis_map_year_dairy_and_egg" class="vis_map_year"></div>
        <br>
        <label>
          <span>Product Selection: </span>
          <select name="Product_Type" id="Product_Type_first_map" onfocus="this.selectedIndex = -1;">
            <option value="Cereals" selected="true">Cereals</option>
            <option value="Fruits and nuts">Fruits and nuts</option>
            <option value="Vegetables">Vegetables</option>
            <option value="Dairy and egg">Dairy and egg</option>
            <option value="Meat">Meat</option>
          </select>
        </label>
      </div>
    </div>

    <!-- ranking plot -->
    <div class="pure-g">
      <div class="pure-u-1-3">
        <div class="description description-left">
            However, this change has just kept up with population growth. For most crops,
            the amount of food produced per capita has increased very slightly. At the same time, many countries still have very low production of food per capita, 
            It seems the road to a world without hunger remains.
        </div>
      </div>
      <div class="pure-u-2-3">
        <div id="vis_per_capita"></div>
      </div>
    </div>

    <!-- Summary row -->
    <div class="pure-g">
        <div class="pure-u-1-3">
            <div class="description description-left">
                Overall, there has been steady growth in productivity and production quality.
                While this may not be very surprising, this has not come easy without investment, education, and innovations.
            </div>
        </div>
        <div class="pure-u-2-3">
            <div id="vis_summary_growth"></div>
        </div>
    </div>

    <!-- Header row for section 2 -->
    <div class="pure-g">
      <div class="pure-u-1-1">
        <h2>Major types of food products</h2>
      </div>
    </div>

    <br/>
    <!-- Transtion row-->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div class="description">
                Different countries will naturally tend to specialise in certain types of products to suit their climate and technologies.
                However, most countries, even developed economies where one might assume higher value products are favoured, cereal - the main type of food humans consume - is produced the most.
                At the same time, certain countries do specialise heavily.
            </div>
        </div>
    </div>

    <!-- large linked map -->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div id="vis_map_type_linked"></div>
        </div>
    </div>

    <!-- Further description -->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div class="description description-right">
              The gap in productivity between countries with the technologies and infrastructure and those without can be massive.
              Sadly, it is the poorer countries who struggle to increase their agriculture productivity that have the most people to feed.
            </div>
        </div>
    </div>
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div id="vis_bump_chart"></div>
        </div>

    </div>

    <!-- Treemap row -->
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div class="description description-right">
              Within each broader category, there is a large gap between the most produced food types and the rest. 
              Unsurprisingly, bananas, apples, pork, beef, corn, and wheat are all very common products.
              Surprisingly, we produce a massive amount of watermelons and cabbages!
            </div>
        </div>
    </div>
    <div class="pure-g">
        <div class="pure-u-1-1">
            <div id="vis_top_5_product"></div>
        </div>
    </div>

  </div> <!-- end page -->

  <!-- "filter" by product type -->
  <script type="text/javascript">
    let maps = document.getElementsByClassName("vis_map_year");
    for (i=0; i < maps.length; i++) {
      let map = maps[i];
      if (map.id == "vis_map_year_cereals") {
        map.removeAttribute("hidden");
      } else
        maps[i].setAttribute("hidden", "");
    }

    let selector = document.getElementById("Product_Type_first_map");
    selector.onchange = () => {
      let value = selector.children[selector.selectedIndex].value;
      value = value.split(",")[0].toLowerCase().replaceAll(" ", "_");

      let maps = document.getElementsByClassName("vis_map_year");
      for (i=0; i < maps.length; i++) {
        let map = maps[i];
        if (map.id == ("vis_map_year_" + value)) {
          map.removeAttribute("hidden");
        }
        else
          maps[i].setAttribute("hidden", "");
      }
    };
  </script>

  <script type="text/javascript">
    ['cereals', 'vegetables', 'dairy_and_egg', 'meat', 'fruits_and_nuts'].map(type => {
      var map = `./js/choropleth_by_type/zoomable_map_yield_major_types_${type}.vg.json`;
      vegaEmbed(`#vis_map_year_${type}`, map, { "actions": false }).then(function (result) {
        // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
      }).catch(console.error);
    });

    var growth_per_capita = './js/line_growth_per_capita.vg.json';
    vegaEmbed('#vis_per_capita', growth_per_capita, { "actions": false }).then(function (result) {}).catch(console.error)

    var major_type_most_produced = "./js/major_type_most_produced.vg.json";
    vegaEmbed('#vis_map_type_linked', major_type_most_produced, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    var top_5_product = "./js/top_5_products.vg.json";
    vegaEmbed('#vis_top_5_product', top_5_product, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    var bump_chart = "./js/bump_chart.vg.json";
    vegaEmbed('#vis_bump_chart', bump_chart, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);

    var summary_growth_by_category = './js/summary_production_yield_by_major_category.vg.json';
    vegaEmbed('#vis_summary_growth', summary_growth_by_category, { "actions": false }).then(function (result) {
      // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
    }).catch(console.error);
  </script>


</body>

</html>